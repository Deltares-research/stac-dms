import{ao as P,m as B,r as n,o as u,c as I,a as O,n as d,w as a,b as l,y as e,U as b,B as f,p as T}from"./31PJL3iA.js";import{G as D,i as g,a as h,b as F,d as x,e as o}from"./Df-LiI8Z.js";import{T as $}from"./C4Cv-8kp.js";/**
 * @license lucide-vue-next v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M=P("MapPinIcon",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-vue-next v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=P("SplineIcon",[["circle",{cx:"19",cy:"5",r:"2",key:"mhkx31"}],["circle",{cx:"5",cy:"19",r:"2",key:"v8kfzx"}],["path",{d:"M5 17A12 12 0 0 1 17 5",key:"1okkup"}]]),N={class:"relative"},A={class:"absolute top-0 right-0 z-10 p-3 flex flex-col gap-2"},J={class:"flex flex-col"},U=B({__name:"GeometryDraw",props:{onValueChange:{type:Function},initialValue:{},readOnly:{}},setup(y){let m=new D,_=n("EPSG:4326"),C=m.readFeatures(y.initialValue,{featureProjection:"EPSG:4326",dataProjection:"EPSG:4326"}),V=n([0,0]),z=n(1),p=n(),i=n(!1),S=n("Polygon"),E=t=>{let r=p.value.source;r.getFeatures().forEach(s=>{s!==t.feature&&r.removeFeature(s)}),i.value=!1},k=n();function j(t){k.value=t.selected[0]}function G(t){var s;let r=t.target.getFeatures(),c=m.writeFeaturesObject(r,{dataProjection:"EPSG:4326",featureProjection:"EPSG:4326"});(s=y.onValueChange)==null||s.call(y,c)}document.addEventListener("keydown",t=>{(t.key==="Delete"||t.key==="Backspace")&&w()});function w(){let t=p.value.source;k.value&&t.removeFeature(k.value)}function v(t){S.value=t,i.value=!0}return(t,r)=>{const c=T;return u(),I("div",N,[O("div",A,[O("div",J,[t.readOnly?f("",!0):(u(),d(c,{key:0,variant:"outline",size:"icon",type:"button",onClick:r[0]||(r[0]=()=>v("Point")),class:b({"bg-gray-100":e(S)==="Point"&&e(i),"rounded-b-none":!0})},{default:a(()=>[l(e(M),{class:"w-4 h-4"})]),_:1},8,["class"])),t.readOnly?f("",!0):(u(),d(c,{key:1,variant:"outline",size:"icon",type:"button",onClick:r[1]||(r[1]=()=>v("Polygon")),class:b({"bg-gray-100":e(S)==="Polygon"&&e(i),"rounded-t-none":!0})},{default:a(()=>[l(e(L),{class:"w-4 h-4"})]),_:1},8,["class"]))]),e(k)?(u(),d(c,{key:0,variant:"outline",size:"icon",type:"button",onClick:w},{default:a(()=>[l(e($),{class:"w-4 h-4"})]),_:1})):f("",!0)]),l(e(g).OlMap,{class:"rounded overflow-hidden aspect-[16/9] w-full",loadTilesWhileAnimating:!0,loadTilesWhileInteracting:!0},{default:a(()=>[l(e(g).OlView,{projection:e(_),rotation:0,ref:"view",center:e(V),zoom:e(z)},null,8,["projection","center","zoom"]),l(e(h).OlTileLayer,null,{default:a(()=>[l(e(F).OlSourceOsm)]),_:1}),e(i)?f("",!0):(u(),d(e(x).OlInteractionSelect,{key:0,onSelect:j},{default:a(()=>[l(e(o).OlStyle,null,{default:a(()=>[l(e(o).OlStyleStroke,{color:"blue",width:10}),l(e(o).OlStyleFill,{color:"rgba(255, 255, 255, 0.4)"}),l(e(o).OlStyleIcon,null,{default:a(()=>r[2]||(r[2]=[O("span",{class:"w-5 h-5 bg-black/40 border-blue-500 border-[10px]"},null,-1)])),_:1})]),_:1})]),_:1})),l(e(h).OlVectorLayer,null,{default:a(()=>[l(e(F).OlSourceVector,{ref_key:"vectorRef",ref:p,onChange:G,features:e(C),format:e(m)},{default:a(()=>[e(i)?(u(),d(e(x).OlInteractionDraw,{key:0,type:e(S),stopClick:!0,onDrawend:e(E)},{default:a(()=>[l(e(o).OlStyle,null,{default:a(()=>[l(e(o).OlStyleStroke,{color:"blue",width:2}),l(e(o).OlStyleFill,{color:"rgba(255, 255, 0, 0.4)"}),l(e(o).OlStyleCircle,{radius:5},{default:a(()=>[l(e(o).OlStyleFill,{color:"#00dd11"}),l(e(o).OlStyleStroke,{color:"blue",width:2})]),_:1})]),_:1})]),_:1},8,["type","onDrawend"])):f("",!0)]),_:1},8,["features","format"]),l(e(o).OlStyle,null,{default:a(()=>[l(e(o).OlStyleStroke,{color:"red",width:2}),l(e(o).OlStyleFill,{color:"rgba(255,255,255,0.1)"}),l(e(o).OlStyleCircle,{radius:7},{default:a(()=>[l(e(o).OlStyleFill,{color:"red"})]),_:1})]),_:1})]),_:1})]),_:1})])}}});export{U as _};
